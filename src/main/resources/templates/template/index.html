<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
  <link href='/css/main.css' rel='stylesheet' />
  <script src='/js/main.js'></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

<script>

  document.addEventListener('DOMContentLoaded', async function() {
    var calendarEl = document.getElementById('calendar');
    var cal;

    await $.ajax({
      type : 'POST',
      url : 'calendar/getcalendar',
      success: function (res) {
        cal = res;
      }
    })
    function today(){
      $.ajax({
        type: 'POST',
        url: 'calendar/gettoday',
        success:function(res) {
          return res;
        }
      })
    }
    /*function getCalendar() {
      $.ajax({
        type : 'POST',
        url : 'calendar/getcalendar',
        success:function (res){
          calendar = res;
          console.log(calendar);
        }
      });
    }*/

    var calendar = new FullCalendar.Calendar(calendarEl, {
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
      },
      initialDate: today(),
      navLinks: true, // can click day/week names to navigate views
      businessHours: true, // display business hours
      editable: true,
      selectable: true,
      events: cal,
      select: function(startDate, endDate, jsEvent, view) {
        $(".fc-body").unbind('click');
        $(".fc-body").on('click', 'tr > td', function(e) {
          $("#contextMenu")
            .removeClass('contextOpened')
            .css({
              display: "block",
              left: e.pageX,
              top:e.pageY
            });
          return false;
        });



      }

      /*[
        {
          title: 'Business Lunch',
          start: '2020-09-03T13:00:00',
          constraint: 'businessHours'
        },
        {
          title: 'Meeting',
          start: '2020-09-13T11:00:00',
          constraint: 'availableForMeeting', // defined below
          color: '#257e4a'
        },
        {
          title: 'Conference',
          start: '2020-09-18',
          end: '2020-09-20'
        },
        {
          title: 'Party',
          start: '2020-09-29T20:00:00'
        },

        // areas where "Meeting" must be dropped
        {
          groupId: 'availableForMeeting',
          start: '2020-09-11T10:00:00',
          end: '2020-09-11T16:00:00',
          display: 'background'
        },
        {
          groupId: 'availableForMeeting',
          start: '2020-09-13T10:00:00',
          end: '2020-09-13T16:00:00',
          display: 'background'
        },

        // red areas where no events can be dropped
        {
          start: '2020-09-24',
          end: '2020-09-28',
          overlap: false,
          display: 'background',
          color: '#ff9f89'
        },
        {
          start: '2020-09-06',
          end: '2020-09-08',
          overlap: false,
          display: 'background',
          color: '#ff9f89'
        }
      ]*/
    });

    calendar.render();
  });

</script>
<style>

  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1100px;
    margin: 0 auto;
  }

</style>
</head>
<body>

  <div id='calendar'></div>

  <!-- 일자 클릭시 메뉴오픈 -->

  <div id="contextMenu" class="dropdown" style=" display: block; position: absolute">
    <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
      <li><a tabindex="-1" class="dropdown-item" href="#">Action</a></li>
      <li><a tabindex="-1" class="dropdown-item" href="#">Another action</a></li>
      <li><a tabindex="-1" class="dropdown-item" href="#">Something else here</a></li>
    </ul>
  </div>

</body>
<script>

</script>
</html>
